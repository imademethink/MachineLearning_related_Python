#!/usr/bin/env python3
# -*- coding: utf-8 -*-

from pylab import plot,show
from numpy import vstack, array
from numpy.random import rand
from scipy.cluster.vq import vq
from scipy.cluster.vq import kmeans
import numpy as np

# Clustering basics - diagram
# K-means clustering - eucleadian distance, root of squares formulae
# centroid and distortions
# kmeans method and parameter (mandatory, optional) explaination
# simple to complex examples
#       different data points
#       centroid moves towards dense area
#       iteration count (default=10) and centroid co-ordinate value consistency
#       centroid count
# vector quantisation
# plotting
# kmeans2 example

# data points


data_random1=vstack((rand(100,2) + array([8.5,8.5]),rand(100,2)))
data_random2=vstack((rand(100,2),rand(100,2)))

data_random3= np.array(
[[ 0.2315442   ,0.08154918],
 [ 0.5890856   ,0.04191172],
 [ 0.73992765  ,0.48268088],
 [ 0.685127    ,0.62830243],
 [ 0.85595794  ,0.9777321 ],
 [ 0.43790153  ,0.18143163],
 [ 0.84953132  ,0.66442584],
 [ 0.48461803  ,0.1930875 ],
 [ 0.79328746  ,0.98047694],
 [ 0.59342587  ,0.22178788],
 [ 0.07000106  ,0.64797721],
 [ 0.10012845  ,0.49217315],
 [ 0.92398924  ,0.61006119],
 [ 0.57990117  ,0.76433655],
 [ 0.17830677  ,0.67076134],
 [ 0.59589868  ,0.83257455],
 [ 0.58652818  ,0.66624732],
 [ 0.85988002  ,0.53510297],
 [ 0.50389765  ,0.51685756],
 [ 0.43146032  ,0.67320314],
 [ 0.38960752  ,0.67255437],
 [ 0.9976311   ,0.13096314],
 [ 0.08022864  ,0.05824648],
 [ 0.2326459   ,0.5876278 ],
 [ 0.44896901  ,0.8123103 ],
 [ 0.79482603  ,0.55832762],
 [ 0.68717323  ,0.86378272],
 [ 0.56296379  ,0.85250216],
 [ 0.56270174  ,0.69745681],
 [ 0.98212627  ,0.99817653],
 [ 0.65410651  ,0.37018013],
 [ 0.52516847  ,0.37040932],
 [ 0.95549009  ,0.97997831],
 [ 0.22918038  ,0.49535164],
 [ 0.87547141  ,0.78279235],
 [ 0.12596654  ,0.25675021],
 [ 0.5338613   ,0.26078435],
 [ 0.30621832  ,0.17250463],
 [ 0.12284936  ,0.55361625],
 [ 0.29457936  ,0.46982749],
 [ 0.44839987  ,0.24615357],
 [ 0.10235002  ,0.28348741],
 [ 0.81122157  ,0.81457323],
 [ 0.10259419  ,0.02454622],
 [ 0.26077027  ,0.72613862],
 [ 0.93025957  ,0.36900298],
 [ 0.70975341  ,0.71391347],
 [ 0.13735107  ,0.78738926],
 [ 0.17535543  ,0.80597969],
 [ 0.62433714  ,0.00315437],
 [ 0.52767265  ,0.72533976],
 [ 0.25163547  ,0.11340502],
 [ 0.74563503  ,0.79404622],
 [ 0.91792927  ,0.71418083],
 [ 0.47232407  ,0.87425733],
 [ 0.76856728  ,0.39848662],
 [ 0.98033633  ,0.27935627],
 [ 0.49225363  ,0.29950225],
 [ 0.00839859  ,0.53332866],
 [ 0.11989853  ,0.81902022],
 [ 0.68728011  ,0.60777994],
 [ 0.02687078  ,0.33928906],
 [ 0.68262781  ,0.36277487],
 [ 0.56006647  ,0.64848127],
 [ 0.89861136  ,0.88783185],
 [ 0.24782299  ,0.7589634 ],
 [ 0.83199177  ,0.76971267],
 [ 0.72776195  ,0.96131512],
 [ 0.27928481  ,0.34752554],
 [ 0.71239999  ,0.32135059],
 [ 0.86271169  ,0.40013367],
 [ 0.07125165  ,0.3335256 ],
 [ 0.39576734  ,0.31824184],
 [ 0.19157563  ,0.50941581],
 [ 0.67206272  ,0.75941304],
 [ 0.9777586   ,0.26800378],
 [ 0.05602443  ,0.35566873],
 [ 0.63035842  ,0.01557528],
 [ 0.95749999  ,0.74996682],
 [ 0.27942756  ,0.09064683],
 [ 0.25847996  ,0.71363504],
 [ 0.763823    ,0.64733773],
 [ 0.73619899  ,0.52405016],
 [ 0.62298457  ,0.9317618 ],
 [ 0.59150603  ,0.38028091],
 [ 0.04121438  ,0.3804692 ],
 [ 0.15959271  ,0.64696403],
 [ 0.92755172  ,0.03281428],
 [ 0.21316597  ,0.74638989],
 [ 0.11294068  ,0.79479806],
 [ 0.4189057   ,0.37644702],
 [ 0.97539603  ,0.7943182 ],
 [ 0.11140333  ,0.19207751],
 [ 0.40320039  ,0.79799966],
 [ 0.31816097  ,0.88951933],
 [ 0.94345066  ,0.46209366],
 [ 0.9837622   ,0.80792112],
 [ 0.30278376  ,0.0914996 ],
 [ 0.39140387  ,0.04974121],
 [ 0.57791956  ,0.94921993],
 [ 0.41954903  ,0.12643194],
 [ 0.51192858  ,0.01007042],
 [ 0.56874501  ,0.76463532],
 [ 0.49777369  ,0.9433635 ],
 [ 0.0427051   ,0.52881419],
 [ 0.62214152  ,0.73656405],
 [ 0.28350714  ,0.26519714],
 [ 0.66154673  ,0.74775026],
 [ 0.87072976  ,0.36525713],
 [ 0.39687087  ,0.56110281],
 [ 0.06219769  ,0.97995888],
 [ 0.99742251  ,0.45057884],
 [ 0.59876538  ,0.97796707],
 [ 0.2011514   ,0.90910216],
 [ 0.83008119  ,0.04080403],
 [ 0.37459985  ,0.01531807],
 [ 0.19745142  ,0.87078839],
 [ 0.08267301  ,0.90123785],
 [ 0.44931186  ,0.85503263],
 [ 0.16017363  ,0.37994271],
 [ 0.95771997  ,0.42189917],
 [ 0.94765163  ,0.44311582],
 [ 0.05379528  ,0.28224361],
 [ 0.60744493  ,0.19061474],
 [ 0.26028921  ,0.37078798],
 [ 0.79445023  ,0.00313386],
 [ 0.26860629  ,0.4985999 ],
 [ 0.40389445  ,0.71748157],
 [ 0.20900346  ,0.42235894],
 [ 0.47211746  ,0.14708312],
 [ 0.64879834  ,0.03474524],
 [ 0.97397008  ,0.5607631 ],
 [ 0.23049759  ,0.97976162],
 [ 0.55229957  ,0.56639671],
 [ 0.25946932  ,0.7730503 ],
 [ 0.97669712  ,0.61454795],
 [ 0.01554601  ,0.47488858],
 [ 0.22119583  ,0.54302163],
 [ 0.16715746  ,0.24872021],
 [ 0.877577    ,0.18874387],
 [ 0.62345008  ,0.40693788],
 [ 0.35440631  ,0.12742342],
 [ 0.40883951  ,0.7034578 ],
 [ 0.52633334  ,0.26530094],
 [ 0.14536913  ,0.45434292],
 [ 0.63755092  ,0.88451777],
 [ 0.39924366  ,0.88728627],
 [ 0.53046942  ,0.16584598],
 [ 0.42098707  ,0.62308726],
 [ 0.19260897  ,0.31463358],
 [ 0.22082326  ,0.67385245],
 [ 0.56920093  ,0.24642678],
 [ 0.98336783  ,0.76597528],
 [ 0.30580979  ,0.35317838],
 [ 0.2002182   ,0.93559339],
 [ 0.0603124   ,0.97177858],
 [ 0.38333424  ,0.89128949],
 [ 0.11069295  ,0.12064571],
 [ 0.14430513  ,0.8458856 ],
 [ 0.63368814  ,0.3215736 ],
 [ 0.22992493  ,0.80520383],
 [ 0.74038917  ,0.85517682],
 [ 0.77219179  ,0.33817728],
 [ 0.68498165  ,0.70937063],
 [ 0.64508437  ,0.00898026],
 [ 0.89542086  ,0.83536272],
 [ 0.53317796  ,0.54532615],
 [ 0.90385117  ,0.46095824],
 [ 0.95535932  ,0.18076267],
 [ 0.92160608  ,0.86120172],
 [ 0.88608444  ,0.79198266],
 [ 0.8961086   ,0.21454799],
 [ 0.35572842  ,0.90299739],
 [ 0.0668793   ,0.93160908],
 [ 0.72834021  ,0.17727104],
 [ 0.68289004  ,0.8457739 ],
 [ 0.70834869  ,0.01235769],
 [ 0.87242101  ,0.90859535],
 [ 0.52584538  ,0.0083696 ],
 [ 0.84187217  ,0.84682587],
 [ 0.43287305  ,0.62705016],
 [ 0.31298023  ,0.49995207],
 [ 0.34007485  ,0.5318194 ],
 [ 0.01134819  ,0.13626814],
 [ 0.29203223  ,0.69760734],
 [ 0.10589228  ,0.56857113],
 [ 0.31291633  ,0.11453677],
 [ 0.13362812  ,0.7747887 ],
 [ 0.85863033  ,0.52446455],
 [ 0.45304274  ,0.14768956],
 [ 0.55377083  ,0.31192753],
 [ 0.25132548  ,0.9197425 ],
 [ 0.01559308  ,0.33028136],
 [ 0.82867904  ,0.27676483],
 [ 0.10023751  ,0.14853376],
 [ 0.92882509  ,0.84015583],
 [ 0.91240167  ,0.78643182],
 [ 0.59386534  ,0.05783723],
 [ 0.91821082  ,0.98591489],
 [ 0.00230534  ,0.83539045]])


data1= np.array([[1.,0.],[3.,0.],[1.,3.],[3.,3.],
                 [6.,0.],[8.,0.],[6.,3.],[8.,3.]],dtype='float64')
data2= np.array([[1.,0.],[3.,0.],[1.,3.],[3.,3.],[2. ,0.],
                 [6.,0.],[8.,0.],[6.,3.],[8.,3.],[7. ,0.]],dtype='float64')
data3= np.array([[1.,0.],[3.,0.],[1.,3.],[3.,3.],[3. ,1.5],
                 [6.,0.],[8.,0.],[6.,3.],[8.,3.],[8. ,1.5]],dtype='float64')
data4= np.array([[1.,0.],[3.,0.],[1.,3.],[3.,3.],[4. ,1.5],
                 [6.,0.],[8.,0.],[6.,3.],[8.,3.],[9. ,1.5]],dtype='float64')
data5= np.array([[1.,0.],[2.,0.],[3.,0.],[1.,.5],[3. ,.5],[1. ,1.],[2., 1.],[3. ,1],
                 [6.,0.],[7.,0.],[8.,0.],[6.,.5],[8. ,.5],[6. ,1.],[7., 1.],[8. ,1]],dtype='float64')
data6= np.array([[1.,1.],[2.,2.],[3.,3.],[4.,4.],[5. ,5.],
                 [2.,1.],[3.,2.],[4.,3.],[5.,4.],[6. ,5.]],dtype='float64')


data                = data1
#data               = whiten(data1)
centroid_count      = 2
iterations_kmeans   = 1000
threshold_kmeans    = 0.01
# computing K-Means with K = 2 (2 clusters)
for x in range(0, 1):
    centroids,distortion = kmeans(
            data,
            centroid_count,
            iterations_kmeans,
            threshold_kmeans)
    print("centroids  =\n",centroids)
    print("distortion =\n",distortion)
# assign each sample to a cluster
idx,_ = vq(data,centroids)
print("idx  =\n",idx)

# some plotting using numpy's logical indexing
plot(data[idx==0,0],data[idx==0,1],'ob',
     data[idx==1,0],data[idx==1,1],'or')
plot(centroids[:,0],
     centroids[:,1],'sg',
     markersize=8)
show()

# use this for 3 centroids when data= data6
plot(data[idx==0,0],data[idx==0,1],'ob',
     data[idx==1,0],data[idx==1,1],'or',
     data[idx==2,0],data[idx==2,1],'og') # third cluster points
plot(centroids[:,0],centroids[:,1],'sm',markersize=8)
show()
